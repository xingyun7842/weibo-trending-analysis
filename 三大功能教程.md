# 🎓 Claude Code 三大功能实战教程

## 案例：微博热搜监控与分析系统

---

## 📖 目录
1. [Output Style（输出风格）](#1-output-style)
2. [Background Commands（后台命令）](#2-background-commands)
3. [Subagent（子代理）](#3-subagent)

---

## 1. Output Style（输出风格）

### 设置方法
```bash
# 查看当前设置
claude config get outputStyle

# 设置不同模式
claude config set outputStyle learning   # 学习模式（推荐新手）
claude config set outputStyle concise    # 简洁模式
claude config set outputStyle detailed   # 详细模式
claude config set outputStyle default    # 默认模式
```

### 各模式特点
- **learning（学习模式）**：会留下部分代码让你填写，边做边学
- **concise（简洁模式）**：输出更简洁，适合有经验的用户
- **detailed（详细模式）**：输出详细解释，适合需要了解细节的场景
- **default（默认模式）**：平衡的输出风格

### 实际效果对比
```
默认模式输出：
"我会创建一个监控脚本..."

学习模式输出：
"我会创建监控脚本的主体框架，你需要补充数据获取部分。
请在 fetch_data() 函数中填写 API 调用代码..."
```

---

## 2. Background Commands（后台命令）

### 什么时候用后台命令？
✅ 长时间运行的任务（监控、定时任务）
✅ 不需要实时查看输出的任务
✅ 7×24 小时运行的服务
✅ 大批量数据处理

### 如何使用？

#### 方式1：在 Claude 对话中使用
```
你: "帮我后台运行 weibo_monitor.py，让它持续监控"

Claude 会使用 Bash 工具的 run_in_background 参数
```

#### 方式2：手动运行
```bash
# Windows
start /b python weibo_monitor.py

# Linux/Mac
nohup python weibo_monitor.py > monitor.log 2>&1 &
```

#### 查看后台任务
```bash
# 在 Claude Code 中
/tasks

# 或在命令行
# Windows: 任务管理器
# Linux/Mac: ps aux | grep python
```

#### 停止后台任务
```bash
# 使用 Claude Code
# Claude 会提供 KillShell 工具

# 或在命令行
# Windows: taskkill /F /IM python.exe
# Linux/Mac: kill <PID>
```

---

## 3. Subagent（子代理）

### 什么时候用 Subagent？
✅ **非编码类任务**（重要！）
  - 数据分析
  - 信息收集和研究
  - 代码库探索
  - 文档生成
  - 数据处理

✅ **重复性任务**
  - 定制专用 agent 处理特定类型任务
  - 可以复用，提高效率

❌ **不适合编码任务**
  - 写代码直接让主 Claude 做就好

### 如何使用？

#### 在对话中触发
```
你: "帮我创建一个专门的 agent 来分析微博热搜数据"

Claude 会使用 Task 工具创建 Subagent
```

#### Subagent 类型
- **general-purpose**: 通用任务
- **Explore**: 探索代码库
- **Bash**: 命令执行
- **Plan**: 设计实现计划

### 实战例子
```
你: "用 subagent 分析 weibo_monitor_log.jsonl 文件，
     找出最热门的话题和趋势"

Claude 创建一个数据分析 Subagent:
1. 读取日志文件
2. 统计分析
3. 生成报告
4. 返回结果给主 Claude
```

---

## 🚀 完整实战流程

### 步骤1：启动后台监控
```
你: "后台运行 weibo_monitor.py，每小时采集一次微博热搜，持续运行"

Claude: 使用 Bash 工具 + run_in_background 参数启动监控
```

### 步骤2：创建分析 Subagent
```
你: "创建一个 subagent 每天定时分析监控数据，生成趋势报告"

Claude: 使用 Task 工具创建专门的数据分析 Subagent
```

### 步骤3：查看和管理
```bash
# 查看所有后台任务
/tasks

# 读取监控日志
/read weibo_monitor_log.jsonl

# 停止某个任务
# Claude 会提供 KillShell 工具
```

---

## 💡 进阶技巧

### 1. 组合使用三个功能
```
场景：持续监控 + 自动分析 + 学习模式

1. 设置学习模式：claude config set outputStyle learning
2. 启动后台监控：后台运行监控脚本
3. 创建分析 Agent：定时触发数据分析
4. 在学习模式下，Claude 会教你如何优化脚本
```

### 2. 实际业务场景
- **日志监控**：后台监控 + 异常检测 Subagent
- **数据采集**：后台爬虫 + 数据清洗 Subagent
- **自动化测试**：后台测试 + 报告生成 Subagent
- **性能监控**：后台收集指标 + 分析优化 Subagent

### 3. Subagent 最佳实践
```python
# 为不同任务类型打磨专用 Subagent

分析型 Agent：
- 数据统计
- 趋势分析
- 报告生成

研究型 Agent：
- 信息收集
- 文献搜索
- 知识整理

处理型 Agent：
- 数据清洗
- 格式转换
- 批量操作
```

---

## 🎯 快速参考

```bash
# Output Style
claude config set outputStyle learning

# 后台命令（在 Claude 对话中）
"后台运行 script.py"

# Subagent（在 Claude 对话中）
"创建一个 subagent 来分析数据"

# 查看任务
/tasks

# 查看配置
claude config list
```

---

## 📝 小结

1. **Output Style**：根据你的经验选择合适的输出模式
2. **Background Commands**：长时间运行的任务放后台
3. **Subagent**：为非编码的重复任务创建专用 agent

**关键点**：这些功能是"用出来的"，多尝试才能掌握！
